<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geolocation Line Walker PWA</title>
  <link rel="canonical" href="https://mszawerda.github.io/github-page-pwa-poc/" />
  <link rel="icon" href="img/icon.png" type="image/png">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
</head>
<body>
  <div class="container">
    <h1>Geolocation Line Walker</h1>
    
    <div class="status-panel">
      <div class="status-item">
        <strong>Status:</strong> <span id="status">Initializing...</span>
      </div>
      <div class="status-item">
        <strong>Current Location:</strong> <span id="current-location">Loading...</span>
      </div>
      <div class="status-item">
        <strong>Progress:</strong> <span id="progress">0%</span>
      </div>
      <div class="status-item">
        <strong>Distance to Line:</strong> <span id="distance-to-line">--</span>
      </div>
    </div>

    <div class="controls">
      <button id="reset-btn" disabled>Reset Line</button>
      <button id="locate-btn">Center Map on Me</button>
    </div>

    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
  <script>
      if (navigator.serviceWorker) {
        // Detect if running locally or on GitHub Pages
        const isLocal = window.location.hostname === 'localhost' || 
                       window.location.hostname === '127.0.0.1' || 
                       window.location.hostname === '';
        
        const swPath = isLocal ? './sw.js' : '/github-page-pwa-poc/sw.js';
        const scope = isLocal ? './' : '/github-page-pwa-poc/';
        
        navigator.serviceWorker.register(swPath, { scope: scope })
          .then(registration => {
            console.log('ServiceWorker registration successful:', registration);
          })
          .catch(error => {
            console.log('ServiceWorker registration failed:', error);
          });
      }
  </script>
  <script src="js/app.js"></script>
</body>
</html>